# PE
## Q1
```Python
print(sum(x for x in range(1, 1000) if x % 3 == 0 or x % 5 == 0))
```
## Q2
```Python
f = [1, 2]
s = 2
for i in range(100):
    f.append(f[-1] + f[-2])
    if f[-1] >= 4000000:
        break
    if f[-1] % 2 == 0:
        s += f[-1]
print(s)
```
## Q3
```Python
print(naive_factorization(600851475143)[-1][0])
```
## Q4
```Python
ans = 0
for i in range(100, 1000):
    for j in range(100, 1000):
        s = i * j
        if str(s) == str(s)[::-1]:
            ans = max(ans, s)
print(ans)
```
## Q5
```Python
def gcd(a: int, b: int):
    if b:
        return gcd(b, a % b)
    else:
        return a


def lcm(a: int, b: int):
    return a // gcd(a, b) * b


n = 1
for i in range(1, 21):
    n = lcm(n, i)
print(n)
```
## Q6
```Python
n = 100
print((n * (n + 1) // 2) ** 2 - n * (n + 1) * (2 * n + 1) // 6)
```
## Q7
```Python
pr = []
N = 1000000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1

for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1

print(pr[10000])
```
## Q8
```Python
ls = [int(x) for x in open('r.txt', 'r').readlines()[0]]
ans = 0
for i in range(len(ls) - 13):
    m = 1
    for j in range(13):
        m *= ls[i + j]
    ans = max(ans, m)
print(ans)
```
## Q9
```Python
for a in range(1, 1000):
    for b in range(a + 1, 1000):
        s = a * a + b * b
        c = int(sqrt(s))
        if c * c != s:
            continue
        if a + b + c == 1000:
            print(a * b * c)
```
## Q10
```Python
pr = []
N = 2000000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1

for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1

print(sum(pr))
```
## Q11
```Python
ls = open('r.txt', 'r').readlines()
a = []
for s in ls:
    s = s[:-1]
    a.append([int(x) for x in s.split(' ')])
n = m = 20
ans = 0
for i in range(n - 3):
    for j in range(m - 3):
        x = a[i][j] * a[i][j + 1] * a[i][j + 2] * a[i][j + 3]
        y = a[i][j] * a[i + 1][j] * a[i + 2][j] * a[i + 3][j]
        z = a[i][j] * a[i + 1][j + 1] * a[i + 2][j + 2] * a[i + 3][j + 3]
        w = a[i][m - j - 1] * a[i + 1][m - j - 2] * a[i + 2][m - j - 3] * a[i + 3][m - j - 4]
        ans = max(ans, x, y, z, w)
print(ans)
```

## Q12
```Python
for i in range(1, 100000):
    x = i * (i + 1) // 2
    res = naive_factorization(x)
    m = 1
    for p, e in res:
        m *= e + 1
    if m >= 500:
        print(x)
        break
```
## Q13
```Python
ls = open('r.txt', 'r').readlines()
a = []
for s in ls:
    a.append(int(s[:-1]))
print(str(sum(a))[:10])
```
## Q14
```Python
n = 999999
mp = {}
def dfs(u: int):
    if u is 1:
        return 1
    elif u in mp.keys():
        return mp[u]
    elif u & 1:
        mp[u] = dfs(u * 3 + 1) + 1
    else:
        mp[u] = dfs(u >> 1) + 1
    return mp[u]
ans, mx = 0, 0
for i in range(1, n + 1):
    if dfs(i) > mx:
        mx = dfs(i)
        ans = i
print(ans)
```
## Q15
```Python
n, N = 20, 45
C = [[0 for x in range(N)] for y in range(N)]
for i in range(N):
    C[i][0] = C[i][i] = 1
    for j in range(i):
        C[i][j] = C[i - 1][j - 1] + C[i - 1][j]
print(C[n * 2][n])
```
## Q16
```Python
ans, v = 0, 1 << 1000
while v:
    ans += v % 10
    v //= 10
print(ans)
```
## Q17
```Python
mp = {
    0: "",
    1: "one",
    2: "two",
    3: "three",
    4: "four",
    5: "five",
    6: "six",
    7: "seven",
    8: "eight",
    9: "nine",
    10: "ten",
    11: "eleven",
    12: "twelve",
    13: "thirteen",
    14: "fourteen",
    15: "fifteen",
    16: "sixteen",
    17: "seventeen",
    18: "eighteen",
    19: "nineteen",
    20: "twenty",
    30: "thirty",
    40: "forty",
    50: "fifty",
    60: "sixty",
    70: "seventy",
    80: "eighty",
    90: "ninety",
    100: "hundred",
    1000: "one thousand",
}
ans = len(mp[1000]) - 1
mq = {}
for i in range(1000):
    if i <= 20:
        ans += len(mp[i])
        mq[i] = len(mp[i])
    elif i < 100:
        u, v = i // 10 * 10, i % 10
        ans += len(mp[u]) + len(mp[v])
        mq[i] = len(mp[u]) + len(mp[v])
    else:
        u, v = i // 100, i % 100
        ans += mq[u] + 7
        if v > 0:
            ans += mq[v] + 3

print(ans)
```
## Q18
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=104;
int t,f[N][N],n=15;
int main(){
    freopen("r.txt","r",stdin);
    for(int i=1;i<=n;i++)
    for(int j=1;j<=i;j++){
        scanf("%d",&t);
        f[i][j]=max(f[i-1][j-1],f[i-1][j])+t;
    }
    printf("%d\n",*max_element(f[n]+1,f[n]+n+1));
}

```
## Q19
```C++
# include <bits/stdc++.h>
using namespace std;
bool isl(int y){
    return y%4==0&&y%100||y%400==0;
}
int mn[14]={0,31,28,31,30,31,30,31,31,30,31,30,31};
int que(int y,int m,int d){
    int ans=0;
    for(int i=1900;i<y;i++)
        ans+=isl(i)?366:365;
    for(int i=1;i<m;i++)
        ans+=isl(y)&&i==2?29:mn[i];
    ans+=d-1;
    return ans;
}
int main(){
    int ans=0;
    for(int y=1901;y<=2000;y++)
    for(int m=1;m<=12;m++){
        if(que(y,m,1)%7==6) ++ans;
    }
    printf("%d\n",ans);
}
```
## Q20
```Python
f = 1
for i in range(1, 101):
    f *= i
ans = 0
while f:
    ans += f % 10
    f //= 10
print(ans)
```
## Q21
```Python
N = 10000
d = [0]
for i in range(1, N + 1):
    ls = naive_factorization(i)
    w = 1
    for p, e in ls:
        w *= (p ** (e + 1) - 1) // (p - 1)
    d.append(w - i)
sum = 0
for i in range(1, N + 1):
    if N >= d[i] > i == d[d[i]]:
        sum += i + d[i]
print(sum)

```
## Q22
```Python
ls = open('r.txt', 'r').readlines()[0].split(',')
ls.sort()
ans = 0
for i in range(len(ls)):
    s = ls[i][1:-1]
    sum = 0
    for ch in s:
        sum += ord(ch) - ord('A') + 1
    ans += sum * (i + 1)
print(ans)
```
## Q23
```Python
N = 28123
a = []
for i in range(1, N + 1):
    ls = naive_factorization(i)
    w = 1
    for p, e in ls:
        w *= (p ** (e + 1) - 1) // (p - 1)
    if w - i > i:
        a.append(i)

st = set()
for i in range(len(a)):
    for j in range(i, len(a)):
        st.add(a[i] + a[j])
sum = 0
for i in range(1, N + 1):
    if i not in st:
        sum += i
print(sum)
```
## Q24
```C++
# include <bits/stdc++.h>
using namespace std;
char s[12]="0123456789";
int main(){
    int n=999999;
    for(int i=0;i<n;i++)
        next_permutation(s,s+10);
    puts(s);
}
```
## Q25
```Python
f = [0, 1, 1]
for i in range(3, 5000):
    f.append(f[-1] + f[-2])
    if f[i] >= 10**999:
        print(i)
        break
```
## Q26
```C++
# include <bits/stdc++.h>
using namespace std;
int f[1004];
int main(){
    int n=1000,mx=0,ans=0;
    for(int x=2,t=0;x<n;x++){
        memset(f,-1,sizeof(f));
        int w=0;
        for(int j=1,k=0;j;j=j*10%x){
            if(f[j]!=-1){
                w=k-f[j];
                break;
            }
            f[j]=k++;
        }
        if(w>mx) mx=w,ans=x;
    }
    printf("%d\n",ans);
}
```
## Q27
```C++
# include <bits/stdc++.h>
typedef long long ll;
using namespace std;
const int N=1000004;
bool v[N];
vector<int>pr;
int main(){
    for(int i=2;i<N;i++){
        if(v[i]) continue;
        if(i<=1000) pr.push_back(i);
        for(ll j=1ll*i*i;j<N;j+=i)
            v[j]=1;
    }
    v[0]=v[1]=1;
    int ans=0,mx=0,n;
    for(int b:pr)
    for(int a=-1000;a<=1000;++a){
        for(n=0;n*n+n*a+b>=0&&!v[n*n+n*a+b];++n);
        if(n>mx) mx=n,ans=a*b;
    }
    printf("%d\n",ans);
}

```
## Q28
```Python
n = 1001
ans = 0
for i in range(1, n // 2 + 2):
    ans += 4 * i * i - 10 * i + 7
    ans += 4 * (i - 1) * (i - 1) + 1
    ans += 4 * i * i - 6 * i + 3
    ans += (2 * i - 1) ** 2
print(ans - 3)
```
## Q29
```Python
n = 100
st = set()
for a in range(2, n + 1):
    for b in range(2, n + 1):
        st.add(a ** b)
print(len(st))
```
## Q30
```Python
ans = 0
for x in range(2, 300000):
    s, w = 0, x
    while w:
        s += (w % 10) ** 5
        w //= 10
    if s == x:
        ans += x
print(ans)
```
## Q31
```Python
n = 200
ls = [1, 2, 5, 10, 20, 50, 100, 200]
f = [0 for x in range(n + 1)]
f[0] = 1
for x in ls:
    for i in range(n - x + 1):
        f[i + x] += f[i]
print(f[n])
```
## Q32
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=1000004;
bool v[14];
int a[14]={0,1,2,3,4,5,6,7,8,9};
set<int>st;
int main(){
    do{
        for(int l=2;l<=8;l++)
        for(int r=l;r<=8;r++){
            int x=0,y=0,z=0;
            for(int i=1;i<=9;i++){
                if(i<l) x=x*10+a[i];
                else if(i<=r) y=y*10+a[i];
                else z=z*10+a[i];
            }
            if(x*y==z) st.insert(z);
        }
    }while(next_permutation(a+1,a+10));
    int s=0;
    for(int x:st)
        s+=x;
    printf("%d\n",s);
}
```
## Q33
```Python
def gcd(a: int, b: int) -> int:
    if b == 0:
        return a
    else:
        return gcd(b, a % b)


a, b = 1, 1
for x in range(10, 100):
    for y in range(x + 1, 100):
        ok = 0
        u, v = x // 10, y % 10
        if x * v == y * u and x % 10 == y // 10: ok = 1
        u, v = x % 10, y // 10
        if x * v == y * u and x // 10 == y % 10: ok = 1
        if ok:
            a *= x
            b *= y

g = gcd(a, b)
print(b // g)
```
## Q34
```Python
f = [1]
for i in range(1, 10):
    f.append(f[-1] * i)
N = 260000
ans = 0
for x in range(3, N):
    s, v = 0, x
    while v:
        s += f[v % 10]
        v //= 10
    if s == x:
        ans += x
print(ans)
```
## Q35
```Python
pr = []
N = 1000000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1

for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1


def change(x: int):
    s = str(x)
    return int(s[-1] + s[:-1])


ans = 0
for x in pr:
    m = len(str(x))
    v, ok = x, 1
    for i in range(m):
        if f[x]:
            ok = 0
            break
        x = change(x)
    ans += ok
print(ans)
```
## Q36
```Python
N = 1000000
sum = 0
for i in range(N):
    s, t = str(i), bin(i)[2:]
    if s == s[::-1] and t == t[::-1]:
        sum += i
print(sum)
```
## Q37
```Python
pr = []
N = 1000000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1

for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1

ans = 0
for x in pr:
    if x < 10:
        continue
    s = str(x)
    m = len(s)
    ok = 1
    for i in range(1, m):
        if f[int(s[:i])] or f[int(s[i:])]:
            ok = 0
            break
    if ok:
        ans += x
print(ans)
```
## Q38
```Python
b = "123456789"
ans = 0
for i in range(1, 100000):
    t = ""
    for x in range(1, 10):
        t += str(i * x)
        if len(t) >= 9:
            break
    u = "".join((lambda x: (x.sort(), x)[1])(list(t)))
    if u == b:
        ans = max(ans, int(t))
print(ans)
```
## Q39
```Python
from math import sqrt
n = 1000
a = [0 for x in range(4000)]
for x in range(3, n + 1):
    for y in range(x + 1, n + 1):
        s = x * x + y * y
        z = int(sqrt(s))
        if z * z == s:
            a[x + y + z] += 1

p = 0
for i in range(n + 1):
    if a[i] > a[p]:
        p = i
print(p)
```
## Q40
```Python
n = 200000
s = "0"
for i in range(1, n + 1):
    s += str(i)
ls = [1, 10, 100, 1000, 10000, 100000, 1000000]
m = 1
for x in ls:
    m *= ord(s[x]) - ord('0')
print(m)
```
## Q41
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=32004;
bool v[N];
vector<int>pr;
int a[N];
bool ok(int w){
    for(int x:pr){
        if(x*x>w) break;
        if(w%x==0) return 0;
    }
    return 1;
}
int main(){
    for(int i=2;i<N;i++){
        if(v[i]) continue;
        pr.push_back(i);
        for(int j=i*i;j<N;j+=i)
            v[j]=1;
    }
    int ans=0;
    for(int k=2;k<=9;k++){
        for(int i=1;i<=k;i++)
            a[i]=i;
        do{
            int w=0;
            for(int i=1;i<=k;i++)
                w=w*10+a[i];
            if(ok(w)) ans=w;
        }while(next_permutation(a+1,a+k+1));
    }
    printf("%d\n",ans);
}
```
## Q42
```Python
ls = [s[1:-1] for s in open('r.txt', 'r').readlines()[0].split(',')]
st = set()
for i in range(1, 41):
    st.add(i * (i + 1) // 2)
ans = 0
for s in ls:
    sum = 0
    for c in s:
        sum += ord(c) - ord('A') + 1
    if sum in st:
        ans += 1
print(ans)
```
## Q43
```Python
t = "0123456789"
ans = 0
for x in permutations(t):
    s = "".join(x)
    ok = 1
    if int(s[1:4]) % 2 != 0 or int(s[2:5]) % 3 != 0 or int(s[3:6]) % 5 != 0 or int(s[4:7]) % 7 != 0 or \
            int(s[5:8]) % 11 != 0 or int(s[6:9]) % 13 != 0 or int(s[7:10]) % 17 != 0:
        ok = 0
    if ok:
        ans += int(s)
print(ans)
```
## Q44
```Python
st = set()
N = 3000
for i in range(1, N):
    st.add(i * (3 * i - 1) // 2)
ls = list(st)
ls.sort()
for i in range(len(ls)):
    ok = 0
    d = ls[i]
    for j in range(i):
        x, y = ls[j], ls[j] + d
        if y in st and x + y in st:
            ok = 1
            break
    if ok == 1:
        print(d)
        break
```
## Q45
```Python
s1, s2, s3 = set(), set(), set()
N = 100000
for n in range(1, N + 1):
    s1.add(n * (n + 1) // 2)
    s2.add(n * (3 * n - 1) // 2)
    s3.add(n * (2 * n - 1))
ls = list(s1 & s2 & s3)
ls.sort()
print(ls[2])
```
## Q46
```Python
pr = []
N = 10000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1

for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
for m in range(9, N + 1, 2):
    if f[m] == 0:
        continue
    p = 1
    ok = 1
    while p * p * 2 < m:
        if f[m - p * p * 2] == 0:
            ok = 0
            break
        p += 1
    if ok:
        print(m)
        break
```
## Q47
```Python
m = 22
N = 200000
while m <= N:
    if len(naive_factorization(m + 3)) < 4:
        m += 4
    elif len(naive_factorization(m + 2)) < 4:
        m += 3
    elif len(naive_factorization(m + 1)) < 4:
        m += 2
    elif len(naive_factorization(m)) < 4:
        m += 1
    else:
        print(m)
        break
```
## Q48
```Python
n = 1000
ans = 0
mod = 10000000000
for i in range(1, n + 1):
    ans = (ans + quick_power(i, i, mod)) % mod
print(ans)
```
## Q49
```Python
pr = []
N = 10000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
mp = {}
for p in pr:
    if p >= 1000:
        s = "".join((lambda x: (x.sort(), x)[1])(list(str(p))))
        if s not in mp.keys():
            mp[s] = []
        mp[s].append(p)
for t, v in mp.items():
    for x in v:
        for y in v:
            for z in v:
                if x < y < z and y * 2 == x + z:
                    print(str(x) + str(y) + str(z))
```
## Q50
```Python
pr = []
N = 1000000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
s = [0]
st = set()
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        s.append(s[-1] + i)
        st.add(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
ans = 0
for l in range(2, 600):
    for i in range(l, len(pr) + 1):
        if s[i] - s[i - l] in st:
            ans = s[i] - s[i - l]
            break
        elif s[i] - s[i - l] > N:
            break
print(ans)
```
## Q51
```Python
from Q7_7 import *
from Q16_2 import *
from itertools import permutations

pr = []
M = 6
N = 10 ** M
O = N // 10
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
pst, past = set(), set()
for i in range(2, N + 1):
    if f[i] == 0:
        if i > O:
            pr.append(i)
            pst.add(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
ans = 0
mp = {}


def fun(s: str):
    mn = -1
    if s in mp.keys():
        return mp[s]
    c = 0
    for i in range(0, 10):
        if int(s.replace('*', chr(ord("0") + i))) in pst:
            c += 1
            if mn == -1:
                mn = int(s.replace('*', chr(ord("0") + i)))

    mp[s] = c
    return c, mn


st3 = []
for i in range(1 << (M-1)):
    if bin(i).count('1') == 3:
        st3.append(i)

for x in pr:
    m = len(str(x))
    st = 2
    ok = 0
    for st in st3:
        i = 0
        s, v = "", x
        while v:
            if st >> i & 1:
                s += '*'
            else:
                s += chr(ord("0") + v % 10)
            i += 1
            v //= 10
        past.add(s)

ans = N
for pattern in past:
    c, x = fun(pattern)
    if c >= 8:
        ans = min(ans, x)
print(ans)
```
## Q52
```Python
n = 1000000
for x in range(1, n + 1):
    i = 1
    st = set()
    while i <= 6 and len(st) < 2:
        st.add("".join((lambda x: (x.sort(), x)[1])(list(str(x * i)))))
        i += 1
    if len(st) == 1:
        print(x)
        break
```
## Q53
```Python
n, N = 100, 104
C = [[0 for x in range(N)] for y in range(N)]
for i in range(N):
    C[i][0] = C[i][i] = 1
    for j in range(i):
        C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % 1000000007
ans = 0
for i in range(1, n+1):
    for j in range(0, i):
        if C[i][j] >= 1000000:
            ans += 1
print(ans)
```
## Q54
```Python
def same_suit(p):
    for i in range(4):
        if p[i][1] != p[i + 1][1]:
            return False
    return True


def order(p):
    for i in range(4):
        if ord(p[i + 1][0]) - ord(p[i][0]) != 1:
            return False
    return True


def getlevel(p):
    v = p[0][0] + p[1][0] + p[2][0] + p[3][0] + p[4][0]
    if same_suit(p) and order(p):
        if p[4][0] == 'M':
            return p, p[4], 10
        else:
            return p, p[4], 9
    elif v[0] == v[1] == v[2] == v[3]:
        return p[0:4], p[3], 8
    elif v[1] == v[2] == v[3] == v[4]:
        return p[1:5], p[4], 8
    elif v[0] == v[1] == v[2] and v[3] == v[4] or \
            v[2] == v[3] == v[4] and v[0] == v[1]:
        return p, p[2], 7
    elif same_suit(p):
        return p, p[4], 6
    elif order(p):
        return p, p[4], 5
    elif v[0] == v[1] == v[2]:
        return p[0:3], p[2], 4
    elif v[3] == v[1] == v[2]:
        return p[1:4], p[2], 4
    elif v[3] == v[4] == v[2]:
        return p[2:5], p[2], 4
    elif v[0] == v[1] and v[2] == v[3]:
        return p[0:4], p[3], 3
    elif v[0] == v[1] and v[3] == v[4]:
        return p[0:2] + p[3:5], p[3], 3
    elif v[1] == v[2] and v[3] == v[4]:
        return p[1:5], p[3], 3
    elif v[0] == v[1]:
        return p[0:2], p[1], 2
    elif v[1] == v[2]:
        return p[1:3], p[1], 2
    elif v[2] == v[3]:
        return p[2:4], p[3], 2
    elif v[3] == v[4]:
        return p[3:5], p[3], 2
    else:
        return [p[4]], p[4], 1


def cmp(p1, p2):
    x1, y1, z1 = getlevel(p1)
    x2, y2, z2 = getlevel(p2)
    if z1 > z2:
        return 1
    elif z1 < z2:
        return 0
    if y1[0] > y2[0]:
        return 1
    elif y1[0] < y2[0]:
        return 0
    l1 = list(set(p1) - set(x1))
    l2 = list(set(p2) - set(x2))
    l1.sort()
    l2.sort()
    if l1[-1][0] > l2[-1][0]:
        return 1
    return 0


ls = [s[:-1].split(' ') for s in open('r.txt', 'r').readlines()]
mp = {'2': 'A', '3': 'B', '4': 'C', '5': 'D', '6': 'E', '7': 'F', '8': 'G', '9': 'H', 'T': 'I', 'J': 'J', 'Q': 'K',
      'K': 'L', 'A': 'M'}
ans = 0
for v in ls:
    for i in range(len(v)):
        v[i] = mp[v[i][0]] + v[i][1]
    p1, p2 = v[0:5], v[5:10]
    p1.sort()
    p2.sort()
    ans += cmp(p1, p2)
print(ans)
```
## Q55
```Python
def ok(n: int):
    for i in range(50):
        n = n + int(str(n)[::-1])
        if str(n) == str(n)[::-1]:
            return 0
    return 1


ans = 0
for i in range(10, 10001):
    if ok(i):
        ans += 1
print(ans)
```
## Q56
```Python
def fun(x: int):
    s = 0
    while x:
        s += x % 10
        x //= 10
    return s


N = 100
ans = 0
for a in range(N - 10, N):
    for b in range(N - 10, N):
        ans = max(ans, fun(a ** b))
print(ans)
```
## Q57
```Python
from fractions import Fraction

a = Fraction(1, 1)
N = 1000
ans = 0
for i in range(1000):
    a = 1 / (1 + a) + 1
    if len(str(a.numerator)) > len(str(a.denominator)):
        ans += 1
print(ans)
```
## Q58
```Python
pr = []
N = 1000000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
st = set()
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1


def f(n: int):
    if n % 2 == 0:
        m = n >> 1
        return m * m + m + 1
    elif n % 4 == 1:
        m = n >> 2
        return (2 * m + 1) ** 2
    else:
        m = (n + 1) >> 2
        return m * m * 4 + 1


def isp(n: int):
    i = 0
    while i < len(pr) and pr[i] * pr[i] <= n:
        if n % pr[i] == 0:
            return 0
        i += 1
    return 1


pt, sz = 0, 1


def add(x: int):
    global pt, sz
    if isp(x):
        pt += 1
    sz += 1


for i in range(2, 100000):
    if i % 2 == 0:
        add(f(2 * i - 2))
    else:
        add(f(2 * i - 3))
        add(f(2 * i - 2))
        add(f(2 * i - 1))
    if pt * 10 < sz:
        print(i)
        break
```
## Q59
```Python
l, r = ord('a'), ord('z')
ls = [int(x) for x in open('r.txt', 'r').readlines()[0].split(',')]
lt = [l, l, l]
msg = ls
ok = 1
while ok and lt[0] <= r:
    lt[1] = l
    while ok and lt[1] <= r:
        lt[2] = l
        while ok and lt[2] <= r:
            p = 0
            f = 1
            s = ""
            val = 0
            while p < len(ls) and f:
                w = ls[p] ^ lt[p % 3]
                s += chr(w)
                if w < 31 or w > 127:
                    f = 0
                p += 1
                val += w
            if f and "this" in s and "equal" in s:
                ok = 0
                print(val)

            lt[2] += 1
        lt[1] += 1
    lt[0] += 1
```
## Q60
```Python
pr = []
N = 10000
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1


def isp(n: int):
    i = 0
    while i < len(pr) and pr[i] * pr[i] <= n:
        if n % pr[i] == 0:
            return 0
        i += 1
    return 1


for i in range(2, N + 1):
    if f[i] == 0:
        if i > 2:
            pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1

n = len(pr)
g = [[0 for i in range(n)] for j in range(n)]
for i in range(n):
    for j in range(i + 1):
        x, y = pr[i], pr[j]
        u, v = int(str(x) + str(y)), int(str(y) + str(x))
        if isp(u) and isp(v):
            g[i][j] = g[j][i] = 1

a = [0, 0, 0, 0, 0]


def dfs(p: int, f: int):
    if f == 5:
        print(a, sum([pr[x] for x in a]))
        return 1
    while p < n:
        i = 0
        while i < f:
            if g[a[i]][p] == 0:
                break
            i += 1
        if i == f:
            a[f] = p
            if dfs(p + 1, f + 1):
                return 1
        p += 1
    return 0


print(dfs(0, 0))
```
## Q61
```Python
n = 100
g = [[[] for j in range(n)] for i in range(6)]
f = [[[-1 for j in range(n)] for k in range(n)] for i in range(1 << 6)]


def add(p: int, m: int):
    if m < 1000 or m > 9999:
        return
    x, y = m // 100, m % 100
    g[p][x].append(y)


for i in range(10, 1000):
    add(0, i * (i + 1) // 2)
    add(1, i * i)
    add(2, i * (3 * i - 1) // 2)
    add(3, i * (2 * i - 1))
    add(4, i * (5 * i - 3) // 2)
    add(5, i * (3 * i - 2))
for x in range(n):
    for y in g[0][x]:
        f[1][x][y] = x * 100 + y

for st in range(1, 1 << 6):
    for j in range(n):
        for k in range(n):
            if f[st][j][k] == -1:
                continue
            for p in range(6):
                if st >> p & 1:
                    continue
                for y in g[p][k]:
                    f[st | 1 << p][j][y] = f[st][j][k] + k * n + y

print(max(f[(1 << 6) - 1][i][i] for i in range(n)))
```
## Q62
```Python
mp = {}
for i in range(1, 10000):
    u = "".join((lambda x: (x.sort(), x)[1])(list(str(i * i * i))))
    if u not in mp.keys():
        mp[u] = []
    mp[u].append(i * i * i)
    if len(mp[u]) == 5:
        print(mp[u][0])
        break
```
## Q63
```Python
n = 300
ans = 0
for b in range(1, n):
    for a in range(1, 10):
        if len(str(a ** b)) == b:
            ans += 1
print(ans)
```
## Q64
```Python
# https://en.wikipedia.org/wiki/Periodic_continued_fraction#Canonical_form_and_repetend
ans = 0
for S in range(2, 10000):
    m = 0
    d = 1
    a0 = int(sqrt(S))
    if a0 ** 2 == S:
        continue
    tm = 0
    a = a0
    while a != 2 * a0:
        m = d * a - m
        d = (S - m * m) / d
        a = int((a0 + m) / d)
        tm += 1
    if tm & 1:
        ans += 1
print(ans)
```
## Q65
```Python
a = [2]
n = 100
v = 0
for i in range(1, n + 1):
    a += [1, 2 * i, 1]
for i in range(1, n + 1):
    t = a[:i][::-1]
    w = Fraction(t[0])
    for i in range(1, len(t)):
        w = 1 / w + t[i]
    v = w.numerator
ans = 0
while v:
    ans += v % 10
    v //= 10
print(ans)
```
## Q66
```Python
ans, mx = 0, 0
for S in range(2, 1001):
    m = 0
    d = 1
    a0 = int(sqrt(S))
    ls = [a0]
    if a0 ** 2 == S:
        continue
    a = a0
    for i in range(1, 80):
        m = d * a - m
        d = (S - m * m) / d
        a = int((a0 + m) / d)
        ls.append(a)
        t = ls[:i][::-1]
        w = Fraction(t[0])
        for i in range(1, len(t)):
            w = 1 / w + t[i]
        x, y = w.numerator, w.denominator
        if x * x - S * y * y == 1:
            if x > mx:
                mx = x
                ans = S
            break
print(ans)
```
## Q67
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=104;
int t,f[N][N],n=100;
int main(){
    freopen("r.txt","r",stdin);
    for(int i=1;i<=n;i++)
    for(int j=1;j<=i;j++){
        scanf("%d",&t);
        f[i][j]=max(f[i-1][j-1],f[i-1][j])+t;
    }
    printf("%d\n",*max_element(f[n]+1,f[n]+n+1));
}
```
## Q68
```Python
a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
ans = 0
for a in permutations(a):
    if min(a[0:5]) != a[0] or 10 in a[5:10]:
        continue
    if a[0] + a[6] + a[7] == a[1] + a[7] + a[8] == a[2] + a[8] + a[9] == a[3] + a[9] + a[5] == a[4] + a[5] + a[6]:
        print(a)
        s = [str(x) for x in a]
        t = s[0] + s[6] + s[7] + s[1] + s[7] + s[8] + s[2] + s[8] + s[9] + s[3] + s[9] + s[5] + s[4] + s[5] + s[6]
        ans = max(ans, int(t))
print(ans)
```
## Q69
```Python
n = 1000000
phi = [i for i in range(n + 1)]

ans = 0
p = 0
for i in range(2, n + 1):
    if i == phi[i]:
        for j in range(i, n + 1, i):
            phi[j] //= i
            phi[j] *= i - 1
    w = i / phi[i]
    if w > ans:
        ans = w
        p = i
print(p)
```
## Q70
```Python
n = 10000000
phi = [i for i in range(n + 1)]
ans = 100.0
p = 0
for i in range(2, n + 1):
    if i == phi[i]:
        for j in range(i, n + 1, i):
            phi[j] //= i
            phi[j] *= i - 1
    if "".join((lambda x: (x.sort(), x)[1])(list(str(i)))) == "".join(
            (lambda x: (x.sort(), x)[1])(list(str(phi[i])))) and i / phi[i] < ans:
        ans = i / phi[i]
        p = i
print(p)
```
## Q71
```C++
# include <bits/stdc++.h>
# define X first
# define Y second
# define pi pair<int,int>
using namespace std;
const int N=1000000;
int gcd(int a,int b){
    return b?gcd(b,a%b):a;
}
vector<pi>v;
bool cmp(pi&a,pi&b){
    return 1ll*a.X*b.Y<1ll*a.Y*b.X;
}
int main(){
    for(int m=2;m<=N;m++){
        int x=m*3/7;
        if(m==7) --x;
        for(;x>0&&gcd(x,m)>1;--x);
        v.push_back(pi(x,m));
    }
    sort(v.begin(),v.end(),cmp);
    pi fr=v.back();
    printf("%d\n",fr.X);
}
```
## Q72
```Python
n = 1000000
phi = [i for i in range(n + 1)]
for i in range(2, n + 1):
    if i == phi[i]:
        for j in range(i, n + 1, i):
            phi[j] //= i
            phi[j] *= i - 1
print(sum(phi)-1)
```
## Q73
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=12000;
int gcd(int a,int b){
    return b?gcd(b,a%b):a;
}
int main(){
    int ans=0;
    for(int m=4;m<=N;m++)
        for(int y=m/3+1;y<(m+1)/2;y++)
            if(gcd(m,y)==1) ++ans;
    printf("%d\n",ans);
}
```
## Q74
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=1000000;
int f[N<<2],fac[14];
int st[N<<2],pos[N<<2];
int dfs(int u,int fl){
    st[fl]=u;
    if(f[u]) return f[u];
    if(pos[u]){
        for(int i=pos[u];i<fl;i++)
            f[st[i]]=fl-pos[u];
        return f[u];
    }
    pos[u]=fl;
    int s=0;
    for(int k=u;k;k/=10)
        s+=fac[k%10];
    int x=dfs(s,fl+1);
    pos[u]=0;
    if(f[u]) return f[u];
    else return f[u]=x+1;
}
int main(){
    fac[0]=1;
    int p=1;
    for(int i=1;i<10;i++)
        fac[i]=fac[i-1]*i;
    int ans=0;
    for(int i=1;i<=N;i++)
        if(dfs(i,1)==60) ++ans;
    printf("%d\n",ans);
}
```
## Q75
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=1500000;
int d[N+4];
int gcd(int a,int b){
    return b?gcd(b,a%b):a;
}
int main(){
    for(int s=1;s<=4000;s+=2)
    for(int t=1;t<s;t+=2){
        if(gcd(s,t)!=1) continue;
        int a=s*t,b=(s*s-t*t)/2,c=(s*s+t*t)/2;
        int s=a+b+c;
        for(int k=s;k<=N;k+=s)
            ++d[k];
    }
    int ans=0;
    for(int i=1;i<=N;i++)
        ans+=(d[i]==1);
    printf("%d\n",ans);
}
```
## Q76
```Python
n = 100
f = [0 for _ in range(n + 1)]
f[0] = 1
for i in range(1, n + 1):
    for j in range(i, n + 1):
        f[j] += f[j - i]
print(f[n] - 1)
```
## Q77
```Python
pr = []
N = 100
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
f = [0 for _ in range(N + 1)]
f[0] = 1
for x in pr:
    for j in range(x, N + 1):
        f[j] += f[j - x]
for i in range(N):
    if f[i] >= 5000:
        print(i)
        break

```
## Q78
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=60000,M=1000000;
int f[N],n=59000;
int cal(int n){
    int sum=0,k=4,a=2,b=1,sgn=1;
    for(;a<=n;){
        sum+=sgn*(f[n-a]+f[n-b]);
        sum=(sum+M)%M;
        a+=k+1;b+=k;
        k+=3;sgn*=-1;
    }
    if(b<=n) sum=(sum+sgn*f[n-b]%M+M)%M;
    return sum;
}
int main(){
    f[0]=f[1]=1;
    for(int i=2;i<=n;i++){
        f[i]=cal(i);
        if(f[i]==0){
            printf("%d\n",i);
            break;
        }
    }
}
```
## Q79
```Python
from queue import Queue

g = [[] for i in range(10)]
d = [0 for i in range(10)]
f = [0 for i in range(10)]
ls = open('r.txt', 'r').readlines()
for s in ls:
    x = int(s[:-1])
    a = x // 100
    b = x // 10 % 10
    c = x % 10
    g[a].append(b)
    g[b].append(c)
    d[b] += 1
    d[c] += 1
    f[a] = f[b] = f[c] = 1
q = Queue()
for i in range(10):
    if d[i] == 0 and f[i]:
        q.put(i)

a = []
while not q.empty():
    u = q.get()
    a.append(u)
    for v in g[u]:
        d[v] -= 1
        if d[v] == 0:
            q.put(v)
print("".join(str(x) for x in a))
```
## Q80
```Python
def sqr(n: int):
    l = int(sqrt(n)) >> 2
    r = int(sqrt(n)) << 2
    while l < r:
        mid = (l + r + 1) >> 1
        if mid * mid <= n:
            l = mid
        else:
            r = mid - 1
    return l


ans = 0
for i in range(2, 100):
    if i in [4, 9, 16, 25, 36, 49, 64, 81]:
        continue
    w = sqr(i * (10 ** 200))
    while w >= 10 ** 100:
        w //= 10
    while w:
        ans += w % 10
        w //= 10
print(ans)
```
## Q81
```Python
n = 80
f = [[10000000 for x in range(n)] for y in range(n)]
a = []
ls = open('r.txt', 'r').readlines()
for i in range(n):
    b = [int(x) for x in ls[i][:-1].split(',')]
    a.append(b)
for i in range(n):
    for j in range(n):
        if i == 0 and j == 0:
            f[i][j] = 0
        if i > 0:
            f[i][j] = min(f[i][j], f[i - 1][j])
        if j > 0:
            f[i][j] = min(f[i][j], f[i][j - 1])
        f[i][j] += a[i][j]
print(f[n - 1][n - 1])
```
## Q82
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=80;
int a[N+4][N+4],s[N+4][N+4],f[N+4][N+4];
int main(){
    freopen("r.txt","r",stdin);
    memset(f,0x3f,sizeof(f));
    for(int i=1;i<=N;i++)
        for(int j=1;j<=N;j++){
            scanf("%d,",&a[i][j]);
            s[i][j]=s[i-1][j]+a[i][j];
        }
    for(int i=1;i<=N;i++)
        f[i][1]=a[i][1]=a[i][1];
    for(int j=2;j<=N;j++)
        for(int i=1;i<=N;i++)
        for(int k=1;k<=N;k++){
            f[i][j]=min(f[i][j],f[k][j-1]+s[max(i,k)][j]-s[min(i,k)-1][j]);
        }
    int ans=0x3f3f3f3f;
    for(int i=1;i<=N;i++)
        ans=min(ans,f[i][N]);
    printf("%d\n",ans);
}
```
## Q83
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=80;
int a[N+4][N+4],id[N+4][N+4],m=0;
struct E{
    int next,to,val;
    bool operator <(const E&e) const{
        return val<e.val;
    }
}e[(N*N)<<2];
struct V{
    int p,len;
    bool operator < (const V & v) const{
        return len>v.len;
    }
};
int head[N*N+4],tot=0,d[N*N+4];
void add(int x,int y,int z){
    e[tot]=E{y,head[x],z};
    head[x]=tot++;
}
void DJ(int st){
    priority_queue<V>q;
    q.push(V{st,a[1][1]});
    while(!q.empty()){
        V pre=q.top();q.pop();
        if(d[pre.p] != -1) continue;
        d[pre.p]=pre.len;
        for(int i=head[pre.p];~i;i=e[i].to){
            int v=e[i].next;
            if(d[v]!=-1) continue;
            q.push(V{v,pre.len+e[i].val});
        }
    }
}
int main(){
    freopen("r.txt","r",stdin);
    memset(head,-1,sizeof(head));
    memset(d,-1,sizeof(d));
    for(int i=1;i<=N;i++)
        for(int j=1;j<=N;j++)
            id[i][j]=++m;
    for(int i=1;i<=N;i++)
        for(int j=1;j<=N;j++)
            scanf("%d,",&a[i][j]);
    for(int i=1;i<=N;i++)
    for(int j=1;j<=N;j++){
        if(j<N){
            add(id[i][j],id[i][j+1],a[i][j+1]);
            add(id[i][j+1],id[i][j],a[i][j]);
        }
        if(i<N){
            add(id[i][j],id[i+1][j],a[i+1][j]);
            add(id[i+1][j],id[i][j],a[i][j]);
        }
    }
    DJ(1);
    printf("%d\n",d[N*N]);
}
```
## Q84
```Python
from Q7_7 import *
from Q16_2 import *
from itertools import permutations
from random import randint, shuffle


def get_list():
    ls = [x for x in range(1, 17)]
    shuffle(ls)
    return ls


def get_dices():
    a, b = randint(1, 4), randint(1, 4)
    return a + b, a == b


def next_rail(pos: int):
    if 5 <= pos < 15:
        return 15
    elif 15 <= pos < 25:
        return 25
    elif 25 <= pos < 35:
        return 35
    else:
        return 5


def next_utility(pos: int):
    if 12 <= pos < 28:
        return 28
    else:
        return 12


cards = [-1, 0, 10, 11, 24, 39, 5]


def cc(id: int, pos: int):
    if id <= 2:
        return cards[id]
    else:
        return pos


def ch(id: int, pos: int):
    if id <= 6:
        return cards[id]
    elif 7 <= id <= 8:
        return next_rail(pos)
    elif id == 9:
        return next_utility(pos)
    elif id == 10:
        pos -= 3
        if pos < 0:
            pos += 40
        return pos
    else:
        return pos


cnt = [0 for i in range(40)]
chcard = get_list()
cccard = get_list()
pos = dbc = i = 0
while i < 10 ** 7:
    i += 1
    w, f = get_dices()
    if f:
        dbc += 1
    else:
        dbc = 0
    if dbc == 3:
        pos = 10
        dbc = 0
    else:
        pos += w
        if pos >= 40:
            pos -= 40
        if pos in [2, 17, 33]:
            tp = cccard.pop()
            cccard.insert(0, tp)
            pos = cc(tp, pos)
        elif pos in [7, 22, 36]:
            tp = chcard.pop()
            chcard.insert(0, tp)
            pos = ch(tp, pos)
        elif pos == 30:
            pos = 10
    cnt[pos] += 1
ans = [[i, cnt[i]] for i in range(40)]
ans.sort(key=lambda t: t[1])
print(ans[-1][0], ans[-2][0], ans[-3][0])
```
## Q85
```Python
m = 2000
n = 2000000
ls = [i * (i + 1) // 2 for i in range(m + 1)]
mn = n * n
ans = 0
for i in range(1, m + 1):
    for j in range(i, m + 1):
        w = ls[i] * ls[j]
        if abs(w - n) < abs(mn - n):
            mn = w
            ans = i * j
        if w > n:
            break

print(ans)
```
## Q86
```Python
def issq(n: int):
    m = int(sqrt(n))
    return m * m == n


cnt = 0
c = 1
while cnt <= 10 ** 6:
    ab = 2
    while ab <= c * 2:
        if issq(ab * ab + c * c):
            if ab < c:
                cnt += ab // 2
            else:
                cnt += c - (ab + 1) // 2 + 1
        ab += 1
    c += 1
print(c - 1)
```
## Q87
```Python
pr = []
N = 10000
M = 5 * (10 ** 7)
f = [0 for _ in range(N + 1)]
a2, a3, a4 = [], [], []
f[0] = f[1] = 1
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        if i * i <= M:
            a2.append(i * i)
        if i ** 3 <= M:
            a3.append(i ** 3)
        if i ** 4 <= M:
            a4.append(i ** 4)
        for j in range(i * i, N + 1, i):
            f[j] = 1
st = set()
i = 0
while i < len(a2):
    j = 0
    while j < len(a3) and a2[i] + a3[j] < M:
        k = 0
        while k < len(a4) and a2[i] + a3[j] + a4[k] < M:
            st.add(a2[i] + a3[j] + a4[k])
            k += 1
        j += 1
    i += 1
print(len(st))
```
## Q88
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=12000,M=15;
int f[N+4];
void dfs(int fl,int nw,int m,int s){
    if(fl==M){
        int t=m-s+M;
        if(t<=N)
            f[t]=min(f[t],m);
        return;
    }
    for(int i=nw;i<=N&&m*i<=N*4;i++)
        dfs(fl+1,i,m*i,s+i);
}
int main(){
    memset(f,0x3f,sizeof(f));
    f[2]=4;
    dfs(0,1,1,0);
    set<int>st;
    for(int i=2;i<=N;i++)
        st.insert(f[i]);
    int s=0;
    for(int x:st)
        s+=x;
    printf("%d\n",s);
}
```
## Q89
```Python
mp = {
    'IV': 4, 'IX': 9, 'XL': 40, 'XC': 90, 'CD': 400, 'CM': 900,
    'M': 1000, 'D': 500, 'C': 100, 'L': 50, 'X': 10, 'V': 5, 'I': 1
}
ln = []
for x, y in mp.items():
    ln.append([y, x])
ln.sort()
ln.reverse()


def r2n(s: str):
    ans = 0
    while s != "":
        if len(s) >= 2 and s[0:2] in mp.keys():
            ans += mp[s[0:2]]
            s = s[2:]
        else:
            ans += mp[s[0]]
            s = s[1:]
    return ans


def n2r(n: int):
    s = ""
    while n:
        for x, y in ln:
            if x <= n:
                n -= x
                s += y
                break
    return s


ls = open('r.txt', 'r').readlines()
ans = 0
for s in ls:
    s = s[:-1]
    w = r2n(s)
    ans += len(s)-len(n2r(w))
print(ans)
```
## Q90
```C++
# include <bits/stdc++.h>
using namespace std;
vector<int>g[1004];
int m=0;
bool b[11],d[11];
int x[10]={0,0,0,1,2,3,4,6,8},y[10]={1,4,9,6,5,6,9,4,1};
void dfs(int f,int c){
    if(c==6){
        for(int j=0;j<10;j++)
            if(b[j]) g[m].push_back(j);
        if(b[6]&&!b[9]) g[m].push_back(9);
        else if(b[9]&&!b[6]) g[m].push_back(6);
        m++;
        return;
    }
    if(f==10) return;
    dfs(f+1,c);
    b[f]=1;
    dfs(f+1,c+1);
    b[f]=0;
}
int main(){
    dfs(0,0);
    int ans=0;
    for(int i=0;i<m;i++){
        for(int x:g[i]) b[x]=1;
        for(int j=i;j<m;j++){
            for(int x:g[j]) d[x]=1;
            bool f=1;
            for(int k=0;k<9&&f;k++)
                if(!(b[x[k]]&&d[y[k]]||b[y[k]]&&d[x[k]])) f=0;
            if(f) ++ans;
            memset(d,0,sizeof(d));
        }
        memset(b,0,sizeof(b));
    }
    printf("%d\n",ans);
}
```
## Q91
```Python
def ok(a: complex, b: complex):
    if a.imag * b.imag + a.real * b.real == 0:
        return 1
    u = b - a
    if u.imag * a.imag + u.real * a.real == 0:
        return 1
    v = a - b
    if v.imag * b.imag + v.real * b.real == 0:
        return 1
    return 0


n = 50
ls = []
for i in range(0, n + 1):
    for j in range(0, n + 1):
        if i + j > 0:
            ls.append(complex(i, j))
ans = 0
for i in range(len(ls)):
    for j in range(i + 1, len(ls)):
        if ok(ls[i], ls[j]):
            ans += 1
print(ans)
```
## Q92
```C++
# include <bits/stdc++.h>
using namespace std;
const int M=10000001;
int f[M];
int dfs(int u){
    if(u==1) return 1;
    else if(u==89) return 0;
    else if(f[u]!=-1) return f[u];
    int s=0;
    for(int w=u;w;w/=10)
        s+=(w%10)*(w%10);
    return f[u]=dfs(s);
}
int main(){
    mem(f,-1);
    int ans=0;
    for(int i=1;i<M;i++){
        if(dfs(i)==0) ++ans;
    }
    printf("%d\n",ans);
}
```
## Q93
```Python
from itertools import permutations
from math import floor

eps = 1e-11
op = "+-*/"


def getval(p: tuple):
    st = set()
    for l in range(4):
        for r in range(l, 4):
            for i in range(4):
                for j in range(4):
                    for k in range(4):
                        e = "{}{}{}{}{}{}{}".format(p[0], op[i], p[1], op[j], p[2], op[k], p[3])
                        ls = list(e)
                        ls.insert(2 * r + 1, ')')
                        ls.insert(2 * l, '(')
                        e = "".join(ls)
                        x, y = e.find('('), e.find(')')
                        if eval(e[x + 1:y]) == 0 and e[x - 1] == '/':
                            continue
                        w = eval(e)
                        if w > 0 and abs(w - floor(w + eps)) < eps:
                            st.add(floor(w + eps))
    return st


a = [1, 2, 3, 4, 5, 6, 7, 8, 9]
mp = {}
mx = 0
tp = 0
for p in permutations(a, 4):
    t = list(p)
    t.sort()
    print(p)
    t = tuple(t)
    if t not in mp.keys():
        mp[t] = set()
    mp[t] |= getval(p)
for x, y in mp.items():
    k = 1
    while k in y:
        k += 1
    if k > mx:
        mx = k
        tp = x
print("".join(str(x) for x in tp))
```
## Q94
```C++
# include <bits/stdc++.h>
typedef long long ll;
using namespace std;
ll N=1000000000;
inline ll sqr(ll x){
    ll w=sqrt(x);
    ll l=w-5,r=w+5;
    while(l<r){
        ll mid=(l+r+1)>>1;
        if(mid*mid<=x) l=mid;
        else r=mid-1;
    }
    return l;
}
bool ok(ll a,ll c){
    ll h2=a*a-c*c/4;
    ll h=sqr(h2);
    if(h*h!=h2) return 0;
    return 1;
}
int main(){
    ll ans=0;
    for(ll a=3;;a+=2){
        if(a*3-1>N) break;
        if(ok(a,a+1))
            ans+=a*3+1;
        if(ok(a,a-1))
            ans+=a*3-1;
    }
    printf("%lld\n",ans);
}
```
## Q95
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=10000000;
int f[N+4],s[N+4],pos[N];
int st[N];
int dfs(int u,int fl){
    if(f[u]) return f[u];
    st[fl]=u;
    if(pos[u]){
        for(int i=pos[u];i<fl;i++)
            f[st[i]]=fl-pos[u];
        return f[u];
    }
    pos[u]=fl;
    if(s[u]==0||dfs(s[u],fl+1)==-1||f[u]==0) return f[u]=-1;
    pos[u]=0;
    return f[u];
}
int main(){
    for(int i=1;i<=N;i++)
        for(int j=i+i;j<=N;j+=i)
            s[j]+=i;
    for(int i=1;i<=N;i++)
        if(s[i]>N) s[i]=0;
    int mx=0,ans=0;
    for(int i=1;i<=N;i++){
        if(f[i]==0)
            dfs(i,1);
        if(f[i]>mx){
            mx=f[i];
            ans=i;
        }
    }
    printf("%d\n",ans);
}
```
## Q96
```C++
# include <bits/stdc++.h>
# define lb(x) (x & -x)
using namespace std;
int r[10], c[10], p[10], f[604], g[604], cnt = 0,INF = 0x3f3f3f3f;
inline void get(int & R, int & C, int & P, int i) { R=i/9,C=i%9,P=R/3*3+C/3;}
inline void op(int R, int C, int P, int z)
{
	r[R]^=1<<z;
	c[C]^=1<<z;
	p[P]^=1<<z;
}
void init() { for(int i=0;i<10; i++) r[i]=c[i]=p[i]=(1<<9)-1; cnt=0; }
char s[100];
bool dfs(int cnt)
{
	if (!cnt) return 1;
	int R,C,P,k=INF,v=0;
	for (int i=0;s[i];i++)
		if (s[i]=='.')
		{
			get(R,C,P,i);
			int t=r[R]&c[C]&p[P];
			if (!t) return 0;
			if (g[t]<k)v=i,k=g[t];
		}
	get(R,C,P,v);
	k=r[R]&c[C]&p[P];
	while (k)
	{
		int x=f[lb(k)];
		s[v]=x+'1';
		op(R,C,P,x);
		if (dfs(cnt-1)) return 1;
		s[v] = '.';
		op(R,C,P,x);
		k-=lb(k);
	}
	return 0;
}
int main()
{
    freopen("r.txt","r",stdin);
	int R, C, P;
	for (int i=0;i<=8;i++) f[1<<i]=i;
	for (int i=0;i<600;i++)
	{
		int t=i;
		while(t)t-=lb(t),g[i]++;
	}
	int T,ans=0;
	T=50;
	while(T--){
		init();
		scanf("%s %s",s,s);
		for(int i=0,f=0;i<9;i++,f+=9)
            scanf("%s",s+f);
        for(int i = 0;i < 81;i++)
            if(s[i]=='0')
                s[i]='.';
		for(int i=0;s[i];i++)
		{
			if (s[i]!='.')
			{
				get(R,C,P,i);
				op(R,C,P,s[i]-'1');
			}
			else cnt++;
		}
		dfs(cnt);
		ans+=100*(s[0]-'0');
		ans+=10*(s[1]-'0');
		ans+=s[2]-'0';
	}
	printf("%d\n",ans);
}
```
## Q97
```Python
mod = int(1e10)
print(quick_power(2, 7830457, mod) * 28433 % mod + 1)
```
## Q98
```Python
def cmp(s: str, t: str):
    m = len(s)
    for i in range(m):
        for j in range(i + 1, m):
            if (s[i] == s[j]) ^ (t[i] == t[j]):
                return 0
    return 1


def replace(s: str, t: str, w: str):
    m = len(s)
    mymp = {}
    for i in range(m):
        mymp[s[i]] = t[i]
    z = ""
    for i in range(m):
        z += mymp[w[i]]
    return int(z)


ls = open('r.txt', 'r').readlines()[0].split(',')
mp, mq, mr = {}, {}, {}
pair = []
for s in ls:
    s = s[1:-1]
    u = "".join((lambda x: (x.sort(), x)[1])(list(s)))
    if u not in mp.keys():
        mp[u] = []
    mp[u].append(s)
for y in mp.values():
    if len(y) >= 2:
        m = len(y)
        for i in range(m):
            for j in range(i + 1, m):
                pair.append([y[i], y[j]])

for i in range(1, 31700):
    x = i * i
    if x >= 10 ** 9:
        break
    s = str(x)
    u = "".join((lambda x: (x.sort(), x)[1])(list(s)))
    if u not in mq.keys():
        mq[u] = []
    mq[u].append(x)

for y in mq.values():
    if len(y) >= 2:
        for w in y:
            l = len(str(w))
            if l not in mr.keys():
                mr[l] = set()
            mr[l].add(w)

ans = 0
for x, y in pair:
    m = len(x)
    if m not in mr.keys():
        continue
    for t in mr[m]:
        if cmp(x, str(t)) and replace(x, str(t), y) in mr[m]:
            ans = max(ans, t, replace(x, str(t), y))
print(ans)
```
## Q99
```Python
from math import log10

ls = open('r.txt', 'r').readlines()
ans, i, mx = 0, 0, 0
for s in ls:
    i += 1
    s = s[:-1]
    p, e = [int(x) for x in s.split(',')]
    w = log10(p) * e
    if w > mx:
        mx = w
        ans = i
print(ans)
```
## Q100
```C++
# include <bits/stdc++.h>
typedef long long ll;
using namespace std;
const int M=40;
ll u[M]={0,3,15},v[M]={0,4,21};
int q=0;
int main(){
    for(int i=3;i<M;i++){
        u[i]=v[i-1]*2+u[i-1]*3-2;
        v[i]=v[i-1]*3+u[i-1]*4-3;
        if(v[i]>=1e12){
            printf("%lld\n",u[i]);
            break;
        }
    }
}
```