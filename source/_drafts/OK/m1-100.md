## Q51
```Python
from Q7_7 import *
from Q16_2 import *
from itertools import permutations

pr = []
M = 6
N = 10 ** M
O = N // 10
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
pst, past = set(), set()
for i in range(2, N + 1):
    if f[i] == 0:
        if i > O:
            pr.append(i)
            pst.add(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
ans = 0
mp = {}


def fun(s: str):
    mn = -1
    if s in mp.keys():
        return mp[s]
    c = 0
    for i in range(0, 10):
        if int(s.replace('*', chr(ord("0") + i))) in pst:
            c += 1
            if mn == -1:
                mn = int(s.replace('*', chr(ord("0") + i)))

    mp[s] = c
    return c, mn


st3 = []
for i in range(1 << (M-1)):
    if bin(i).count('1') == 3:
        st3.append(i)

for x in pr:
    m = len(str(x))
    st = 2
    ok = 0
    for st in st3:
        i = 0
        s, v = "", x
        while v:
            if st >> i & 1:
                s += '*'
            else:
                s += chr(ord("0") + v % 10)
            i += 1
            v //= 10
        past.add(s)

ans = N
for pattern in past:
    c, x = fun(pattern)
    if c >= 8:
        ans = min(ans, x)
print(ans)
```
## Q64
```Python
# https://en.wikipedia.org/wiki/Periodic_continued_fraction#Canonical_form_and_repetend
ans = 0
for S in range(2, 10000):
    m = 0
    d = 1
    a0 = int(sqrt(S))
    if a0 ** 2 == S:
        continue
    tm = 0
    a = a0
    while a != 2 * a0:
        m = d * a - m
        d = (S - m * m) / d
        a = int((a0 + m) / d)
        tm += 1
    if tm & 1:
        ans += 1
print(ans)
```
## Q66
```Python
ans, mx = 0, 0
for S in range(2, 1001):
    m = 0
    d = 1
    a0 = int(sqrt(S))
    ls = [a0]
    if a0 ** 2 == S:
        continue
    a = a0
    for i in range(1, 80):
        m = d * a - m
        d = (S - m * m) / d
        a = int((a0 + m) / d)
        ls.append(a)
        t = ls[:i][::-1]
        w = Fraction(t[0])
        for i in range(1, len(t)):
            w = 1 / w + t[i]
        x, y = w.numerator, w.denominator
        if x * x - S * y * y == 1:
            if x > mx:
                mx = x
                ans = S
            break
print(ans)
```
## Q69
```Python
n = 1000000
phi = [i for i in range(n + 1)]

ans = 0
p = 0
for i in range(2, n + 1):
    if i == phi[i]:
        for j in range(i, n + 1, i):
            phi[j] //= i
            phi[j] *= i - 1
    w = i / phi[i]
    if w > ans:
        ans = w
        p = i
print(p)
```
## Q70
```Python
n = 10000000
phi = [i for i in range(n + 1)]
ans = 100.0
p = 0
for i in range(2, n + 1):
    if i == phi[i]:
        for j in range(i, n + 1, i):
            phi[j] //= i
            phi[j] *= i - 1
    if "".join((lambda x: (x.sort(), x)[1])(list(str(i)))) == "".join(
            (lambda x: (x.sort(), x)[1])(list(str(phi[i])))) and i / phi[i] < ans:
        ans = i / phi[i]
        p = i
print(p)
```
## Q71
```C++
# include <bits/stdc++.h>
# define X first
# define Y second
# define pi pair<int,int>
using namespace std;
const int N=1000000;
int gcd(int a,int b){
    return b?gcd(b,a%b):a;
}
vector<pi>v;
bool cmp(pi&a,pi&b){
    return 1ll*a.X*b.Y<1ll*a.Y*b.X;
}
int main(){
    for(int m=2;m<=N;m++){
        int x=m*3/7;
        if(m==7) --x;
        for(;x>0&&gcd(x,m)>1;--x);
        v.push_back(pi(x,m));
    }
    sort(v.begin(),v.end(),cmp);
    pi fr=v.back();
    printf("%d\n",fr.X);
}
```
## Q72
```Python
n = 1000000
phi = [i for i in range(n + 1)]
for i in range(2, n + 1):
    if i == phi[i]:
        for j in range(i, n + 1, i):
            phi[j] //= i
            phi[j] *= i - 1
print(sum(phi)-1)
```
## Q73
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=12000;
int gcd(int a,int b){
    return b?gcd(b,a%b):a;
}
int main(){
    int ans=0;
    for(int m=4;m<=N;m++)
        for(int y=m/3+1;y<(m+1)/2;y++)
            if(gcd(m,y)==1) ++ans;
    printf("%d\n",ans);
}
```
## Q74
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=1000000;
int f[N<<2],fac[14];
int st[N<<2],pos[N<<2];
int dfs(int u,int fl){
    st[fl]=u;
    if(f[u]) return f[u];
    if(pos[u]){
        for(int i=pos[u];i<fl;i++)
            f[st[i]]=fl-pos[u];
        return f[u];
    }
    pos[u]=fl;
    int s=0;
    for(int k=u;k;k/=10)
        s+=fac[k%10];
    int x=dfs(s,fl+1);
    pos[u]=0;
    if(f[u]) return f[u];
    else return f[u]=x+1;
}
int main(){
    fac[0]=1;
    int p=1;
    for(int i=1;i<10;i++)
        fac[i]=fac[i-1]*i;
    int ans=0;
    for(int i=1;i<=N;i++)
        if(dfs(i,1)==60) ++ans;
    printf("%d\n",ans);
}
```
## Q75
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=1500000;
int d[N+4];
int gcd(int a,int b){
    return b?gcd(b,a%b):a;
}
int main(){
    for(int s=1;s<=4000;s+=2)
    for(int t=1;t<s;t+=2){
        if(gcd(s,t)!=1) continue;
        int a=s*t,b=(s*s-t*t)/2,c=(s*s+t*t)/2;
        int s=a+b+c;
        for(int k=s;k<=N;k+=s)
            ++d[k];
    }
    int ans=0;
    for(int i=1;i<=N;i++)
        ans+=(d[i]==1);
    printf("%d\n",ans);
}
```
## Q76
```Python
n = 100
f = [0 for _ in range(n + 1)]
f[0] = 1
for i in range(1, n + 1):
    for j in range(i, n + 1):
        f[j] += f[j - i]
print(f[n] - 1)
```
## Q77
```Python
pr = []
N = 100
f = [0 for _ in range(N + 1)]
f[0] = f[1] = 1
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        for j in range(i * i, N + 1, i):
            f[j] = 1
f = [0 for _ in range(N + 1)]
f[0] = 1
for x in pr:
    for j in range(x, N + 1):
        f[j] += f[j - x]
for i in range(N):
    if f[i] >= 5000:
        print(i)
        break

```
## Q78
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=60000,M=1000000;
int f[N],n=59000;
int cal(int n){
    int sum=0,k=4,a=2,b=1,sgn=1;
    for(;a<=n;){
        sum+=sgn*(f[n-a]+f[n-b]);
        sum=(sum+M)%M;
        a+=k+1;b+=k;
        k+=3;sgn*=-1;
    }
    if(b<=n) sum=(sum+sgn*f[n-b]%M+M)%M;
    return sum;
}
int main(){
    f[0]=f[1]=1;
    for(int i=2;i<=n;i++){
        f[i]=cal(i);
        if(f[i]==0){
            printf("%d\n",i);
            break;
        }
    }
}
```
## Q79
```Python
from queue import Queue

g = [[] for i in range(10)]
d = [0 for i in range(10)]
f = [0 for i in range(10)]
ls = open('r.txt', 'r').readlines()
for s in ls:
    x = int(s[:-1])
    a = x // 100
    b = x // 10 % 10
    c = x % 10
    g[a].append(b)
    g[b].append(c)
    d[b] += 1
    d[c] += 1
    f[a] = f[b] = f[c] = 1
q = Queue()
for i in range(10):
    if d[i] == 0 and f[i]:
        q.put(i)

a = []
while not q.empty():
    u = q.get()
    a.append(u)
    for v in g[u]:
        d[v] -= 1
        if d[v] == 0:
            q.put(v)
print("".join(str(x) for x in a))
```
## Q80
```Python
def sqr(n: int):
    l = int(sqrt(n)) >> 2
    r = int(sqrt(n)) << 2
    while l < r:
        mid = (l + r + 1) >> 1
        if mid * mid <= n:
            l = mid
        else:
            r = mid - 1
    return l


ans = 0
for i in range(2, 100):
    if i in [4, 9, 16, 25, 36, 49, 64, 81]:
        continue
    w = sqr(i * (10 ** 200))
    while w >= 10 ** 100:
        w //= 10
    while w:
        ans += w % 10
        w //= 10
print(ans)
```
## Q82
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=80;
int a[N+4][N+4],s[N+4][N+4],f[N+4][N+4];
int main(){
    freopen("r.txt","r",stdin);
    memset(f,0x3f,sizeof(f));
    for(int i=1;i<=N;i++)
        for(int j=1;j<=N;j++){
            scanf("%d,",&a[i][j]);
            s[i][j]=s[i-1][j]+a[i][j];
        }
    for(int i=1;i<=N;i++)
        f[i][1]=a[i][1]=a[i][1];
    for(int j=2;j<=N;j++)
        for(int i=1;i<=N;i++)
        for(int k=1;k<=N;k++){
            f[i][j]=min(f[i][j],f[k][j-1]+s[max(i,k)][j]-s[min(i,k)-1][j]);
        }
    int ans=0x3f3f3f3f;
    for(int i=1;i<=N;i++)
        ans=min(ans,f[i][N]);
    printf("%d\n",ans);
}
```
## Q83
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=80;
int a[N+4][N+4],id[N+4][N+4],m=0;
struct E{
    int next,to,val;
    bool operator <(const E&e) const{
        return val<e.val;
    }
}e[(N*N)<<2];
struct V{
    int p,len;
    bool operator < (const V & v) const{
        return len>v.len;
    }
};
int head[N*N+4],tot=0,d[N*N+4];
void add(int x,int y,int z){
    e[tot]=E{y,head[x],z};
    head[x]=tot++;
}
void DJ(int st){
    priority_queue<V>q;
    q.push(V{st,a[1][1]});
    while(!q.empty()){
        V pre=q.top();q.pop();
        if(d[pre.p] != -1) continue;
        d[pre.p]=pre.len;
        for(int i=head[pre.p];~i;i=e[i].to){
            int v=e[i].next;
            if(d[v]!=-1) continue;
            q.push(V{v,pre.len+e[i].val});
        }
    }
}
int main(){
    freopen("r.txt","r",stdin);
    memset(head,-1,sizeof(head));
    memset(d,-1,sizeof(d));
    for(int i=1;i<=N;i++)
        for(int j=1;j<=N;j++)
            id[i][j]=++m;
    for(int i=1;i<=N;i++)
        for(int j=1;j<=N;j++)
            scanf("%d,",&a[i][j]);
    for(int i=1;i<=N;i++)
    for(int j=1;j<=N;j++){
        if(j<N){
            add(id[i][j],id[i][j+1],a[i][j+1]);
            add(id[i][j+1],id[i][j],a[i][j]);
        }
        if(i<N){
            add(id[i][j],id[i+1][j],a[i+1][j]);
            add(id[i+1][j],id[i][j],a[i][j]);
        }
    }
    DJ(1);
    printf("%d\n",d[N*N]);
}
```
## Q84
```Python
from Q7_7 import *
from Q16_2 import *
from itertools import permutations
from random import randint, shuffle


def get_list():
    ls = [x for x in range(1, 17)]
    shuffle(ls)
    return ls


def get_dices():
    a, b = randint(1, 4), randint(1, 4)
    return a + b, a == b


def next_rail(pos: int):
    if 5 <= pos < 15:
        return 15
    elif 15 <= pos < 25:
        return 25
    elif 25 <= pos < 35:
        return 35
    else:
        return 5


def next_utility(pos: int):
    if 12 <= pos < 28:
        return 28
    else:
        return 12


cards = [-1, 0, 10, 11, 24, 39, 5]


def cc(id: int, pos: int):
    if id <= 2:
        return cards[id]
    else:
        return pos


def ch(id: int, pos: int):
    if id <= 6:
        return cards[id]
    elif 7 <= id <= 8:
        return next_rail(pos)
    elif id == 9:
        return next_utility(pos)
    elif id == 10:
        pos -= 3
        if pos < 0:
            pos += 40
        return pos
    else:
        return pos


cnt = [0 for i in range(40)]
chcard = get_list()
cccard = get_list()
pos = dbc = i = 0
while i < 10 ** 7:
    i += 1
    w, f = get_dices()
    if f:
        dbc += 1
    else:
        dbc = 0
    if dbc == 3:
        pos = 10
        dbc = 0
    else:
        pos += w
        if pos >= 40:
            pos -= 40
        if pos in [2, 17, 33]:
            tp = cccard.pop()
            cccard.insert(0, tp)
            pos = cc(tp, pos)
        elif pos in [7, 22, 36]:
            tp = chcard.pop()
            chcard.insert(0, tp)
            pos = ch(tp, pos)
        elif pos == 30:
            pos = 10
    cnt[pos] += 1
ans = [[i, cnt[i]] for i in range(40)]
ans.sort(key=lambda t: t[1])
print(ans[-1][0], ans[-2][0], ans[-3][0])
```
## Q85
```Python
m = 2000
n = 2000000
ls = [i * (i + 1) // 2 for i in range(m + 1)]
mn = n * n
ans = 0
for i in range(1, m + 1):
    for j in range(i, m + 1):
        w = ls[i] * ls[j]
        if abs(w - n) < abs(mn - n):
            mn = w
            ans = i * j
        if w > n:
            break

print(ans)
```
## Q86
```Python
def issq(n: int):
    m = int(sqrt(n))
    return m * m == n


cnt = 0
c = 1
while cnt <= 10 ** 6:
    ab = 2
    while ab <= c * 2:
        if issq(ab * ab + c * c):
            if ab < c:
                cnt += ab // 2
            else:
                cnt += c - (ab + 1) // 2 + 1
        ab += 1
    c += 1
print(c - 1)
```
## Q87
```Python
pr = []
N = 10000
M = 5 * (10 ** 7)
f = [0 for _ in range(N + 1)]
a2, a3, a4 = [], [], []
f[0] = f[1] = 1
for i in range(2, N + 1):
    if f[i] == 0:
        pr.append(i)
        if i * i <= M:
            a2.append(i * i)
        if i ** 3 <= M:
            a3.append(i ** 3)
        if i ** 4 <= M:
            a4.append(i ** 4)
        for j in range(i * i, N + 1, i):
            f[j] = 1
st = set()
i = 0
while i < len(a2):
    j = 0
    while j < len(a3) and a2[i] + a3[j] < M:
        k = 0
        while k < len(a4) and a2[i] + a3[j] + a4[k] < M:
            st.add(a2[i] + a3[j] + a4[k])
            k += 1
        j += 1
    i += 1
print(len(st))
```
## Q88
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=12000,M=15;
int f[N+4];
void dfs(int fl,int nw,int m,int s){
    if(fl==M){
        int t=m-s+M;
        if(t<=N)
            f[t]=min(f[t],m);
        return;
    }
    for(int i=nw;i<=N&&m*i<=N*4;i++)
        dfs(fl+1,i,m*i,s+i);
}
int main(){
    memset(f,0x3f,sizeof(f));
    f[2]=4;
    dfs(0,1,1,0);
    set<int>st;
    for(int i=2;i<=N;i++)
        st.insert(f[i]);
    int s=0;
    for(int x:st)
        s+=x;
    printf("%d\n",s);
}
```
## Q90
```C++
# include <bits/stdc++.h>
using namespace std;
vector<int>g[1004];
int m=0;
bool b[11],d[11];
int x[10]={0,0,0,1,2,3,4,6,8},y[10]={1,4,9,6,5,6,9,4,1};
void dfs(int f,int c){
    if(c==6){
        for(int j=0;j<10;j++)
            if(b[j]) g[m].push_back(j);
        if(b[6]&&!b[9]) g[m].push_back(9);
        else if(b[9]&&!b[6]) g[m].push_back(6);
        m++;
        return;
    }
    if(f==10) return;
    dfs(f+1,c);
    b[f]=1;
    dfs(f+1,c+1);
    b[f]=0;
}
int main(){
    dfs(0,0);
    int ans=0;
    for(int i=0;i<m;i++){
        for(int x:g[i]) b[x]=1;
        for(int j=i;j<m;j++){
            for(int x:g[j]) d[x]=1;
            bool f=1;
            for(int k=0;k<9&&f;k++)
                if(!(b[x[k]]&&d[y[k]]||b[y[k]]&&d[x[k]])) f=0;
            if(f) ++ans;
            memset(d,0,sizeof(d));
        }
        memset(b,0,sizeof(b));
    }
    printf("%d\n",ans);
}
```
## Q91
```Python
def ok(a: complex, b: complex):
    if a.imag * b.imag + a.real * b.real == 0:
        return 1
    u = b - a
    if u.imag * a.imag + u.real * a.real == 0:
        return 1
    v = a - b
    if v.imag * b.imag + v.real * b.real == 0:
        return 1
    return 0


n = 50
ls = []
for i in range(0, n + 1):
    for j in range(0, n + 1):
        if i + j > 0:
            ls.append(complex(i, j))
ans = 0
for i in range(len(ls)):
    for j in range(i + 1, len(ls)):
        if ok(ls[i], ls[j]):
            ans += 1
print(ans)
```
## Q92
```C++
# include <bits/stdc++.h>
using namespace std;
const int M=10000001;
int f[M];
int dfs(int u){
    if(u==1) return 1;
    else if(u==89) return 0;
    else if(f[u]!=-1) return f[u];
    int s=0;
    for(int w=u;w;w/=10)
        s+=(w%10)*(w%10);
    return f[u]=dfs(s);
}
int main(){
    mem(f,-1);
    int ans=0;
    for(int i=1;i<M;i++){
        if(dfs(i)==0) ++ans;
    }
    printf("%d\n",ans);
}
```
## Q93
```Python
from itertools import permutations
from math import floor

eps = 1e-11
op = "+-*/"


def getval(p: tuple):
    st = set()
    for l in range(4):
        for r in range(l, 4):
            for i in range(4):
                for j in range(4):
                    for k in range(4):
                        e = "{}{}{}{}{}{}{}".format(p[0], op[i], p[1], op[j], p[2], op[k], p[3])
                        ls = list(e)
                        ls.insert(2 * r + 1, ')')
                        ls.insert(2 * l, '(')
                        e = "".join(ls)
                        x, y = e.find('('), e.find(')')
                        if eval(e[x + 1:y]) == 0 and e[x - 1] == '/':
                            continue
                        w = eval(e)
                        if w > 0 and abs(w - floor(w + eps)) < eps:
                            st.add(floor(w + eps))
    return st


a = [1, 2, 3, 4, 5, 6, 7, 8, 9]
mp = {}
mx = 0
tp = 0
for p in permutations(a, 4):
    t = list(p)
    t.sort()
    print(p)
    t = tuple(t)
    if t not in mp.keys():
        mp[t] = set()
    mp[t] |= getval(p)
for x, y in mp.items():
    k = 1
    while k in y:
        k += 1
    if k > mx:
        mx = k
        tp = x
print("".join(str(x) for x in tp))
```
## Q94
```C++
# include <bits/stdc++.h>
typedef long long ll;
using namespace std;
ll N=1000000000;
inline ll sqr(ll x){
    ll w=sqrt(x);
    ll l=w-5,r=w+5;
    while(l<r){
        ll mid=(l+r+1)>>1;
        if(mid*mid<=x) l=mid;
        else r=mid-1;
    }
    return l;
}
bool ok(ll a,ll c){
    ll h2=a*a-c*c/4;
    ll h=sqr(h2);
    if(h*h!=h2) return 0;
    return 1;
}
int main(){
    ll ans=0;
    for(ll a=3;;a+=2){
        if(a*3-1>N) break;
        if(ok(a,a+1))
            ans+=a*3+1;
        if(ok(a,a-1))
            ans+=a*3-1;
    }
    printf("%lld\n",ans);
}
```
## Q95
```C++
# include <bits/stdc++.h>
using namespace std;
const int N=10000000;
int f[N+4],s[N+4],pos[N];
int st[N];
int dfs(int u,int fl){
    if(f[u]) return f[u];
    st[fl]=u;
    if(pos[u]){
        for(int i=pos[u];i<fl;i++)
            f[st[i]]=fl-pos[u];
        return f[u];
    }
    pos[u]=fl;
    if(s[u]==0||dfs(s[u],fl+1)==-1||f[u]==0) return f[u]=-1;
    pos[u]=0;
    return f[u];
}
int main(){
    for(int i=1;i<=N;i++)
        for(int j=i+i;j<=N;j+=i)
            s[j]+=i;
    for(int i=1;i<=N;i++)
        if(s[i]>N) s[i]=0;
    int mx=0,ans=0;
    for(int i=1;i<=N;i++){
        if(f[i]==0)
            dfs(i,1);
        if(f[i]>mx){
            mx=f[i];
            ans=i;
        }
    }
    printf("%d\n",ans);
}
```

## Q100
```C++
# include <bits/stdc++.h>
typedef long long ll;
using namespace std;
const int M=40;
ll u[M]={0,3,15},v[M]={0,4,21};
int q=0;
int main(){
    for(int i=3;i<M;i++){
        u[i]=v[i-1]*2+u[i-1]*3-2;
        v[i]=v[i-1]*3+u[i-1]*4-3;
        if(v[i]>=1e12){
            printf("%lld\n",u[i]);
            break;
        }
    }
}
```